this.setPersistentToken(JSON.stringify(m),!m.remember));d();return}}catch(t){}f({message:mxResources.get("unknownError")+" (Code: "+c.getStatus()+")"})}),f)};OneDriveClient.prototype.executeRequest=function(d,f,c){var l=mxUtils.bind(this,function(m){var t=!0,y=window.setTimeout(mxUtils.bind(this,function(){t=!1;c({code:App.ERROR_TIMEOUT,retry:l})}),this.ui.timeout);this.get(d,mxUtils.bind(this,function(B){window.clearTimeout(y);t&&(200<=B.getStatus()&&299>=B.getStatus()||404==B.getStatus()?(null==
this.user&&this.updateUser(this.emptyFn,this.emptyFn,!0),f(B)):m||401!==B.getStatus()&&400!==B.getStatus()?c(this.parseRequestText(B)):this.authenticate(function(){l(!0)},c,m))}),mxUtils.bind(this,function(B){window.clearTimeout(y);t&&c(B)}))});null==b||6E4>this.tokenExpiresOn-Date.now()?this.authenticate(function(){l(!0)},c):l(!1)};OneDriveClient.prototype.checkToken=function(d,f){null==b||null==this.tokenRefreshThread||6E4>this.tokenExpiresOn-Date.now()?this.authenticate(d,null!=f?f:this.emptyFn):