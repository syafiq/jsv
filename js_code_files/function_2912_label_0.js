ha.getStatus()&&299>=ha.getStatus()?M("data:image/png;base64,"+ha.getText()):P({message:mxResources.get("unknownError")})}))}else P({message:mxResources.get("drawingTooLarge")})};EditorUi.prototype.createEmbedSvg=function(d,f,g,u,x,A,H){var P=this.editor.graph.getSvg(null,null,null,null,null,null,null,null,null,null,!g),M=P.getElementsByTagName("a");if(null!=M)for(var G=0;G<M.length;G++){var ia=M[G].getAttribute("href");null!=ia&&"#"==ia.charAt(0)&&"_blank"==M[G].getAttribute("target")&&M[G].removeAttribute("target")}u&&
P.setAttribute("content",this.getFileData(!0));f&&this.editor.graph.addSvgShadow(P);if(g){var ja=" ",ha="";u&&(ja="onclick=\"(function(img){if(img.wnd!=null&&!img.wnd.closed){img.wnd.focus();}else{var r=function(evt){if(evt.data=='ready'&&evt.source==img.wnd){img.wnd.postMessage(decodeURIComponent(img.getAttribute('src')),'*');window.removeEventListener('message',r);}};window.addEventListener('message',r);img.wnd=window.open('"+EditorUi.lightboxHost+"/?client=1"+(x?"&edit=_blank":"")+(A?"&layers=1":
"")+"');}})(this);\"",ha+="cursor:pointer;");d&&(ha+="max-width:100%;");this.editor.convertImages(P,mxUtils.bind(this,function(ba){H('<img src="'+Editor.createSvgDataUri(mxUtils.getXml(ba))+'"'+(""!=ha?' style="'+ha+'"':"")+ja+"/>")}))}else ha="",u&&(f=this.getSelectedPageIndex(),P.setAttribute("onclick","(function(svg){var src=window.event.target||window.event.srcElement;while (src!=null&&src.nodeName.toLowerCase()!='a'){src=src.parentNode;}if(src==null){if(svg.wnd!=null&&!svg.wnd.closed){svg.wnd.focus();}else{var r=function(evt){if(evt.data=='ready'&&evt.source==svg.wnd){svg.wnd.postMessage(decodeURIComponent(svg.getAttribute('content')),'*');window.removeEventListener('message',r);}};window.addEventListener('message',r);svg.wnd=window.open('"+
EditorUi.lightboxHost+"/?client=1"+(null!=f?"&page="+f:"")+(x?"&edit=_blank":"")+(A?"&layers=1":"")+"');}}})(this);"),ha+="cursor:pointer;"),d&&(d=parseInt(P.getAttribute("width")),x=parseInt(P.getAttribute("height")),P.setAttribute("viewBox","-0.5 -0.5 "+d+" "+x),ha+="max-width:100%;max-height:"+x+"px;",P.removeAttribute("height")),""!=ha&&P.setAttribute("style",ha),this.editor.addFontCss(P),this.editor.graph.mathEnabled&&this.editor.addMathCss(P),H(mxUtils.getXml(P))};EditorUi.prototype.timeSince=