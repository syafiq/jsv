7!=document.documentMode||this.isOfflineApp()||mxClient.IS_IOS};EditorUi.prototype.showTextDialog=function(c,e){c=new TextareaDialog(this,c,e,null,null,mxResources.get("close"));this.showDialog(c.container,620,460,!0,!0,null,null,null,null,!0);c.init();document.execCommand("selectall",!1,null)};EditorUi.prototype.doSaveLocalFile=function(c,e,g,n,q,p){"text/xml"!=g||/(\.drawio)$/i.test(e)||/(\.xml)$/i.test(e)||/(\.svg)$/i.test(e)||/(\.html)$/i.test(e)||(e=e+"."+(null!=p?p:"drawio"));if(window.Blob&&
navigator.msSaveOrOpenBlob)c=n?this.base64ToBlob(c,g):new Blob([c],{type:g}),navigator.msSaveOrOpenBlob(c,e);else if(mxClient.IS_IE)g=window.open("about:blank","_blank"),null==g?mxUtils.popup(c,!0):(g.document.write(c),g.document.close(),g.document.execCommand("SaveAs",!0,e),g.close());else if(mxClient.IS_IOS&&this.isOffline())navigator.standalone||null==g||"image/"!=g.substring(0,6)?this.showTextDialog(e+":",c):this.openInNewWindow(c,g,n);else{var y=document.createElement("a");p=(null==navigator.userAgent||
0>navigator.userAgent.indexOf("PaleMoon/"))&&"undefined"!==typeof y.download;if(mxClient.IS_GC&&null!=navigator.userAgent){var B=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);p=65==(B?parseInt(B[2],10):!1)?!1:p}if(p||this.isOffline()){y.href=URL.createObjectURL(n?this.base64ToBlob(c,g):new Blob([c],{type:g}));p?y.download=e:y.setAttribute("target","_blank");document.body.appendChild(y);try{window.setTimeout(function(){URL.revokeObjectURL(y.href)},2E4),y.click(),y.parentNode.removeChild(y)}catch(G){}}else this.createEchoRequest(c,
e,g,n,q).simulate(document,"_blank")}};EditorUi.prototype.createEchoRequest=function(c,e,g,n,q,p){c="xml="+encodeURIComponent(c);return new mxXmlRequest(SAVE_URL,c+(null!=g?"&mime="+g:"")+(null!=q?"&format="+q:"")+(null!=p?"&base64="+p:"")+(null!=e?"&filename="+encodeURIComponent(e):"")+(n?"&binary=1":""))};EditorUi.prototype.base64ToBlob=function(c,e){e=e||"";c=atob(c);for(var g=c.length,n=Math.ceil(g/1024),q=Array(n),p=0;p<n;++p){for(var y=1024*p,B=Math.min(y+1024,g),G=Array(B-y),C=0;y<B;++C,++y)G[C]=