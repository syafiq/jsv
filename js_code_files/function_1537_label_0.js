OneDriveClient.prototype.createInlinePicker=function(e,f,c){return mxUtils.bind(this,function(){var l=null,m=document.createElement("div");m.style.position="relative";var t=new CustomDialog(this.ui,m,mxUtils.bind(this,function(){var y=l.getSelectedItem();if(null!=y)if(f&&"object"==typeof y.folder)e({value:[y]});else{if(!y.folder){var C=OneDriveFile.prototype.getIdOf(y);this.executeRequest(this.getItemURL(C),mxUtils.bind(this,function(z){200<=z.getStatus()&&299>=z.getStatus()&&(z=JSON.parse(z.getText()),
e(C,{value:[z]}))}),null)}}else return mxResources.get("invalidSel",null,"Invalid selection")}),null,mxResources.get(f?"save":"open"),null,null,null,null,!0);this.ui.showDialog(t.container,550,500,!0,!0);m.style.width=t.container.parentNode.style.width;m.style.height=parseInt(t.container.parentNode.style.height)-60+"px";l=new mxODPicker(m,null,mxUtils.bind(this,function(y,C,z,A){this.executeRequest(A?y:this.baseUrl+y,function(J){C(JSON.parse(J.getText()))},z)}),mxUtils.bind(this,function(y,C,z,A){this.executeRequest(this.baseUrl+
"/drives/"+C+"/items/"+y,function(J){z(JSON.parse(J.getText()))},A)}),null,null,function(y){f?e({value:[y]}):e(OneDriveFile.prototype.getIdOf(y))},mxUtils.bind(this,function(y){this.ui.showError(mxResources.get("error"),y)}),f,null,null,null,null,c)})};OneDriveClient.prototype.pickFolder=function(e,f){var c=mxUtils.bind(this,function(m){this.ui.showError(mxResources.get("error"),m&&m.message?m.message:m)}),l=mxUtils.bind(this,function(m){var t=this.inlinePicker?this.createInlinePicker(e,!0):mxUtils.bind(this,