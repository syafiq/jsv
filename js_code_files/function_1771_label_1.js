(n?"":Graph.xmlDeclaration+"\n"+Graph.svgFileComment+"\n"+Graph.svgDoctype+"\n")+mxUtils.getXml(J);null!=p&&p(J);return J});e.mathEnabled&&this.editor.addMathCss(q);if(null!=p)this.embedFonts(q,mxUtils.bind(this,function(J){x?this.editor.convertImages(J,mxUtils.bind(this,function(M){C(M)})):C(J)}));else return C(q)};EditorUi.prototype.embedFonts=function(c,e){this.editor.loadFonts(mxUtils.bind(this,function(){try{null!=this.editor.resolvedFontCss&&this.editor.addFontCss(c,this.editor.resolvedFontCss),
this.editor.embedExtFonts(mxUtils.bind(this,function(f){try{null!=f&&this.editor.addFontCss(c,f),e(c)}catch(n){e(c)}}))}catch(f){e(c)}}))};EditorUi.prototype.exportImage=function(c,e,f,n,p,q,y,x,E,A,S,l,u){E=null!=E?E:"png";if(this.spinner.spin(document.body,mxResources.get("exporting"))){var C=this.editor.graph.isSelectionEmpty();f=null!=f?f:C;null==this.thumbImageCache&&(this.thumbImageCache={});try{this.editor.exportToCanvas(mxUtils.bind(this,function(J){this.spinner.stop();try{this.saveCanvas(J,