function(){return mxClient.IS_CHROMEAPP||this.useCanvasForExport};Editor.prototype.getMaxCanvasScale=function(p,B,L){var Q=mxClient.IS_FF?8192:16384;return Math.min(L,Math.min(Q/p,Q/B))};Editor.prototype.exportToCanvas=function(p,B,L,Q,S,R,T,W,X,Y,Z,ea,ca,aa,ba,fa,za,ra){try{R=null!=R?R:!0;T=null!=T?T:!0;ea=null!=ea?ea:this.graph;ca=null!=ca?ca:0;var Aa=X?null:ea.background;Aa==mxConstants.NONE&&(Aa=null);null==Aa&&(Aa=Q);null==Aa&&0==X&&(Aa=fa?this.graph.defaultPageBackgroundColor:"#ffffff");this.convertImages(ea.getSvg(null,
null,ca,aa,null,T,null,null,null,Y,null,fa,za,ra),mxUtils.bind(this,function(ma){try{var ha=new Image;ha.onload=mxUtils.bind(this,function(){try{var ya=function(){mxClient.IS_SF?window.setTimeout(function(){ta.drawImage(ha,0,0);p(Ea,ma)},0):(ta.drawImage(ha,0,0),p(Ea,ma))},Ea=document.createElement("canvas"),Fa=parseInt(ma.getAttribute("width")),qa=parseInt(ma.getAttribute("height"));W=null!=W?W:1;null!=B&&(W=R?Math.min(1,Math.min(3*B/(4*qa),B/Fa)):B/Fa);W=this.getMaxCanvasScale(Fa,qa,W);Fa=Math.ceil(W*
Fa);qa=Math.ceil(W*qa);Ea.setAttribute("width",Fa);Ea.setAttribute("height",qa);var ta=Ea.getContext("2d");null!=Aa&&(ta.beginPath(),ta.rect(0,0,Fa,qa),ta.fillStyle=Aa,ta.fill());1!=W&&ta.scale(W,W);if(ba){var la=ea.view,ua=la.scale;la.scale=1;var Ma=btoa(unescape(encodeURIComponent(la.createSvgGrid(la.gridColor))));la.scale=ua;Ma="data:image/svg+xml;base64,"+Ma;var Ia=ea.gridSize*la.gridSteps*W,ia=ea.getGraphBounds(),va=la.translate.x*ua,sa=la.translate.y*ua,na=va+(ia.x-va)/ua-ca,oa=sa+(ia.y-sa)/
ua-ca,Ca=new Image;Ca.onload=function(){try{for(var da=-Math.round(Ia-mxUtils.mod((va-na)*W,Ia)),ja=-Math.round(Ia-mxUtils.mod((sa-oa)*W,Ia));da<Fa;da+=Ia)for(var pa=ja;pa<qa;pa+=Ia)ta.drawImage(Ca,da/W,pa/W);ya()}catch(xa){null!=S&&S(xa)}};Ca.onerror=function(da){null!=S&&S(da)};Ca.src=Ma}else ya()}catch(da){null!=S&&S(da)}});ha.onerror=function(ya){null!=S&&S(ya)};Y&&this.graph.addSvgShadow(ma);this.graph.mathEnabled&&this.addMathCss(ma);var Pa=mxUtils.bind(this,function(){try{null!=this.resolvedFontCss&&
this.addFontCss(ma,this.resolvedFontCss),ha.src=Editor.createSvgDataUri(mxUtils.getXml(ma))}catch(ya){null!=S&&S(ya)}});this.embedExtFonts(mxUtils.bind(this,function(ya){try{null!=ya&&this.addFontCss(ma,ya),this.loadFonts(Pa)}catch(Ea){null!=S&&S(Ea)}}))}catch(ya){null!=S&&S(ya)}}),L,Z)}catch(ma){null!=S&&S(ma)}};Editor.crcTable=[];for(var l=0;256>l;l++)for(var m=l,t=0;8>t;t++)m=1==(m&1)?3988292384^m>>>1:m>>>1,Editor.crcTable[l]=m;Editor.updateCRC=function(p,B,L,Q){for(var S=0;S<Q;S++)p=Editor.crcTable[(p^