Graph=function(b,e,k,l,B,q){mxGraph.call(this,b,e,k,l);this.themes=B||this.defaultThemes;this.currentEdgeStyle=mxUtils.clone(this.defaultEdgeStyle);this.currentVertexStyle=mxUtils.clone(this.defaultVertexStyle);this.standalone=null!=q?q:!1;b=this.baseUrl;e=b.indexOf("//");this.domainPathUrl=this.domainUrl="";0<e&&(e=b.indexOf("/",e+2),0<e&&(this.domainUrl=b.substring(0,e)),e=b.lastIndexOf("/"),0<e&&(this.domainPathUrl=b.substring(0,e+1)));this.isHtmlLabel=function(J){J=this.getCurrentCellStyle(J);
return null!=J?"1"==J.html||"wrap"==J[mxConstants.STYLE_WHITE_SPACE]:!1};if(this.edgeMode){var D=null,N=null,S=null,F=null,K=!1;this.addListener(mxEvent.FIRE_MOUSE_EVENT,mxUtils.bind(this,function(J,V){if("mouseDown"==V.getProperty("eventName")&&this.isEnabled()){J=V.getProperty("event");var T=J.getState();V=this.view.scale;if(!mxEvent.isAltDown(J.getEvent())&&null!=T)if(this.model.isEdge(T.cell))if(D=new mxPoint(J.getGraphX(),J.getGraphY()),K=this.isCellSelected(T.cell),S=T,N=J,null!=T.text&&null!=
T.text.boundingBox&&mxUtils.contains(T.text.boundingBox,J.getGraphX(),J.getGraphY()))F=mxEvent.LABEL_HANDLE;else{var ca=this.selectionCellsHandler.getHandler(T.cell);null!=ca&&null!=ca.bends&&0<ca.bends.length&&(F=ca.getHandleForEvent(J))}else if(!this.panningHandler.isActive()&&!mxEvent.isControlDown(J.getEvent())&&(ca=this.selectionCellsHandler.getHandler(T.cell),null==ca||null==ca.getHandleForEvent(J))){var Y=new mxRectangle(J.getGraphX()-1,J.getGraphY()-1),p=mxEvent.isTouchEvent(J.getEvent())?
mxShape.prototype.svgStrokeTolerance-1:(mxShape.prototype.svgStrokeTolerance+2)/2;ca=p+2;Y.grow(p);if(this.isTableCell(T.cell)&&!this.isCellSelected(T.cell)&&!(mxUtils.contains(T,J.getGraphX()-ca,J.getGraphY()-ca)&&mxUtils.contains(T,J.getGraphX()-ca,J.getGraphY()+ca)&&mxUtils.contains(T,J.getGraphX()+ca,J.getGraphY()+ca)&&mxUtils.contains(T,J.getGraphX()+ca,J.getGraphY()-ca))){var E=this.model.getParent(T.cell);ca=this.model.getParent(E);if(!this.isCellSelected(ca)){p*=V;var Q=2*p;if(this.model.getChildAt(ca,
0)!=E&&mxUtils.intersects(Y,new mxRectangle(T.x,T.y-p,T.width,Q))||this.model.getChildAt(E,0)!=T.cell&&mxUtils.intersects(Y,new mxRectangle(T.x-p,T.y,Q,T.height))||mxUtils.intersects(Y,new mxRectangle(T.x,T.y+T.height-p,T.width,Q))||mxUtils.intersects(Y,new mxRectangle(T.x+T.width-p,T.y,Q,T.height)))E=this.selectionCellsHandler.isHandled(ca),this.selectCellForEvent(ca,J.getEvent()),ca=this.selectionCellsHandler.getHandler(ca),null!=ca&&(p=ca.getHandleForEvent(J),null!=p&&(ca.start(J.getGraphX(),J.getGraphY(),
p),ca.blockDelayedSelection=!E,J.consume()))}}for(;!J.isConsumed()&&null!=T&&(this.isTableCell(T.cell)||this.isTableRow(T.cell)||this.isTable(T.cell));)this.isSwimlane(T.cell)&&(ca=this.getActualStartSize(T.cell),(0<ca.x||0<ca.width)&&mxUtils.intersects(Y,new mxRectangle(T.x+(ca.x-ca.width-1)*V+(0==ca.x?T.width:0),T.y,1,T.height))||(0<ca.y||0<ca.height)&&mxUtils.intersects(Y,new mxRectangle(T.x,T.y+(ca.y-ca.height-1)*V+(0==ca.y?T.height:0),T.width,1)))&&(this.selectCellForEvent(T.cell,J.getEvent()),
ca=this.selectionCellsHandler.getHandler(T.cell),null!=ca&&(p=mxEvent.CUSTOM_HANDLE-ca.customHandles.length+1,ca.start(J.getGraphX(),J.getGraphY(),p),J.consume())),T=this.view.getState(this.model.getParent(T.cell))}}}));this.addMouseListener({mouseDown:function(J,V){},mouseMove:mxUtils.bind(this,function(J,V){J=this.selectionCellsHandler.handlers.map;for(var T in J)if(null!=J[T].index)return;if(this.isEnabled()&&!this.panningHandler.isActive()&&!mxEvent.isAltDown(V.getEvent())){var ca=this.tolerance;
if(null!=D&&null!=S&&null!=N){if(T=S,Math.abs(D.x-V.getGraphX())>ca||Math.abs(D.y-V.getGraphY())>ca){var Y=this.selectionCellsHandler.getHandler(T.cell);null==Y&&this.model.isEdge(T.cell)&&(Y=this.createHandler(T));if(null!=Y&&null!=Y.bends&&0<Y.bends.length){J=Y.getHandleForEvent(N);var p=this.view.getEdgeStyle(T);ca=p==mxEdgeStyle.EntityRelation;K||F!=mxEvent.LABEL_HANDLE||(J=F);if(ca&&0!=J&&J!=Y.bends.length-1&&J!=mxEvent.LABEL_HANDLE)!ca||null==T.visibleSourceState&&null==T.visibleTargetState||
(this.graphHandler.reset(),V.consume());else if(J==mxEvent.LABEL_HANDLE||0==J||null!=T.visibleSourceState||J==Y.bends.length-1||null!=T.visibleTargetState)ca||J==mxEvent.LABEL_HANDLE||(ca=T.absolutePoints,null!=ca&&(null==p&&null==J||p==mxEdgeStyle.OrthConnector)&&(J=F,null==J&&(J=new mxRectangle(D.x,D.y),J.grow(mxEdgeHandler.prototype.handleImage.width/2),mxUtils.contains(J,ca[0].x,ca[0].y)?J=0:mxUtils.contains(J,ca[ca.length-1].x,ca[ca.length-1].y)?J=Y.bends.length-1:null!=p&&(2==ca.length||3==
ca.length&&(0==Math.round(ca[0].x-ca[1].x)&&0==Math.round(ca[1].x-ca[2].x)||0==Math.round(ca[0].y-ca[1].y)&&0==Math.round(ca[1].y-ca[2].y)))?J=2:(J=mxUtils.findNearestSegment(T,D.x,D.y),J=null==p?mxEvent.VIRTUAL_HANDLE-J:J+1))),null==J&&(J=mxEvent.VIRTUAL_HANDLE)),Y.start(V.getGraphX(),V.getGraphX(),J),V.consume(),this.graphHandler.reset()}null!=Y&&(this.selectionCellsHandler.isHandlerActive(Y)?this.isCellSelected(T.cell)||(this.selectionCellsHandler.handlers.put(T.cell,Y),this.selectCellForEvent(T.cell,
V.getEvent())):this.isCellSelected(T.cell)||Y.destroy());K=!1;D=N=S=F=null}}else if(T=V.getState(),null!=T&&this.isCellEditable(T.cell)){Y=null;if(this.model.isEdge(T.cell)){if(J=new mxRectangle(V.getGraphX(),V.getGraphY()),J.grow(mxEdgeHandler.prototype.handleImage.width/2),ca=T.absolutePoints,null!=ca)if(null!=T.text&&null!=T.text.boundingBox&&mxUtils.contains(T.text.boundingBox,V.getGraphX(),V.getGraphY()))Y="move";else if(mxUtils.contains(J,ca[0].x,ca[0].y)||mxUtils.contains(J,ca[ca.length-1].x,
ca[ca.length-1].y))Y="pointer";else if(null!=T.visibleSourceState||null!=T.visibleTargetState)J=this.view.getEdgeStyle(T),Y="crosshair",J!=mxEdgeStyle.EntityRelation&&this.isOrthogonal(T)&&(V=mxUtils.findNearestSegment(T,V.getGraphX(),V.getGraphY()),V<ca.length-1&&0<=V&&(Y=0==Math.round(ca[V].x-ca[V+1].x)?"col-resize":"row-resize"))}else if(!mxEvent.isControlDown(V.getEvent())){ca=mxShape.prototype.svgStrokeTolerance/2;J=new mxRectangle(V.getGraphX(),V.getGraphY());J.grow(ca);if(this.isTableCell(T.cell)&&
(V=this.model.getParent(T.cell),ca=this.model.getParent(V),!this.isCellSelected(ca)))if(mxUtils.intersects(J,new mxRectangle(T.x,T.y-2,T.width,4))&&this.model.getChildAt(ca,0)!=V||mxUtils.intersects(J,new mxRectangle(T.x,T.y+T.height-2,T.width,4)))Y="row-resize";else if(mxUtils.intersects(J,new mxRectangle(T.x-2,T.y,4,T.height))&&this.model.getChildAt(V,0)!=T.cell||mxUtils.intersects(J,new mxRectangle(T.x+T.width-2,T.y,4,T.height)))Y="col-resize";for(V=T;null==Y&&null!=V&&(this.isTableCell(V.cell)||
this.isTableRow(V.cell)||this.isTable(V.cell));)this.isSwimlane(V.cell)&&(ca=this.getActualStartSize(V.cell),p=this.view.scale,(0<ca.x||0<ca.width)&&mxUtils.intersects(J,new mxRectangle(V.x+(ca.x-ca.width-1)*p+(0==ca.x?V.width*p:0),V.y,1,V.height))?Y="col-resize":(0<ca.y||0<ca.height)&&mxUtils.intersects(J,new mxRectangle(V.x,V.y+(ca.y-ca.height-1)*p+(0==ca.y?V.height:0),V.width,1))&&(Y="row-resize")),V=this.view.getState(this.model.getParent(V.cell))}null!=Y&&T.setCursor(Y)}}}),mouseUp:mxUtils.bind(this,
function(J,V){F=D=N=S=null})})}this.cellRenderer.minSvgStrokeWidth=.1;this.cellRenderer.getLabelValue=function(J){var V=mxCellRenderer.prototype.getLabelValue.apply(this,arguments);J.view.graph.isHtmlLabel(J.cell)&&(V=1!=J.style.html?mxUtils.htmlEntities(V,!1):J.view.graph.sanitizeHtml(V));return V};if("undefined"!==typeof mxVertexHandler){this.setConnectable(!0);this.setDropEnabled(!0);this.setPanning(!0);this.setTooltips(!0);this.setAllowLoops(!0);this.allowAutoPanning=!0;this.constrainChildren=