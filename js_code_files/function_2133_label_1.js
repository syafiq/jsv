var E=mxText.prototype.redraw;mxText.prototype.redraw=function(){E.apply(this,arguments);null!=this.node&&"DIV"==this.node.nodeName&&Graph.processFontAttributes(this.node)};Graph.prototype.createTagsDialog=function(q,D,L){function U(){for(var ea=R.getSelectionCells(),ka=[],sa=0;sa<ea.length;sa++)R.isCellVisible(ea[sa])&&ka.push(ea[sa]);R.setSelectionCells(ka)}function O(ea){R.setHiddenTags(ea?[]:X.slice());U();R.refresh()}function S(ea,ka){ba.innerText="";if(0<ea.length){var sa=document.createElement("table");
sa.setAttribute("cellpadding","2");sa.style.boxSizing="border-box";sa.style.tableLayout="fixed";sa.style.width="100%";var xa=document.createElement("tbody");if(null!=ea&&0<ea.length)for(var ta=0;ta<ea.length;ta++)(function(ha){var Oa=0>mxUtils.indexOf(R.hiddenTags,ha),Ia=document.createElement("tr"),Ca=document.createElement("td");Ca.style.align="center";Ca.style.width="16px";var Fa=document.createElement("img");Fa.setAttribute("src",Oa?Editor.visibleImage:Editor.hiddenImage);Fa.setAttribute("title",
mxResources.get(Oa?"hideIt":"show",[ha]));mxUtils.setOpacity(Fa,Oa?75:25);Fa.style.verticalAlign="middle";Fa.style.cursor="pointer";Fa.style.width="16px";if(D||Editor.isDarkMode())Fa.style.filter="invert(100%)";Ca.appendChild(Fa);mxEvent.addListener(Fa,"click",function(Ja){mxEvent.isShiftDown(Ja)?O(0<=mxUtils.indexOf(R.hiddenTags,ha)):(R.toggleHiddenTag(ha),U(),R.refresh());mxEvent.consume(Ja)});Ia.appendChild(Ca);Ca=document.createElement("td");Ca.style.overflow="hidden";Ca.style.whiteSpace="nowrap";
Ca.style.textOverflow="ellipsis";Ca.style.verticalAlign="middle";Ca.style.cursor="pointer";Ca.setAttribute("title",ha);a=document.createElement("a");mxUtils.write(a,ha);a.style.textOverflow="ellipsis";a.style.position="relative";mxUtils.setOpacity(a,Oa?100:40);Ca.appendChild(a);mxEvent.addListener(Ca,"click",function(Ja){if(mxEvent.isShiftDown(Ja)){O(!0);var oa=R.getCellsForTags([ha],null,null,!0);R.isEnabled()?R.setSelectionCells(oa):R.highlightCells(oa)}else if(Oa&&0<R.hiddenTags.length)O(!0);else{oa=
X.slice();var Ba=mxUtils.indexOf(oa,ha);oa.splice(Ba,1);R.setHiddenTags(oa);U();R.refresh()}mxEvent.consume(Ja)});Ia.appendChild(Ca);if(R.isEnabled()){Ca=document.createElement("td");Ca.style.verticalAlign="middle";Ca.style.textAlign="center";Ca.style.width="18px";if(null==ka){Ca.style.align="center";Ca.style.width="16px";Fa=document.createElement("img");Fa.setAttribute("src",Editor.crossImage);Fa.setAttribute("title",mxResources.get("removeIt",[ha]));mxUtils.setOpacity(Fa,Oa?75:25);Fa.style.verticalAlign=
"middle";Fa.style.cursor="pointer";Fa.style.width="16px";if(D||Editor.isDarkMode())Fa.style.filter="invert(100%)";mxEvent.addListener(Fa,"click",function(Ja){var oa=mxUtils.indexOf(X,ha);0<=oa&&X.splice(oa,1);R.removeTagsForCells(R.model.getDescendants(R.model.getRoot()),[ha]);R.refresh();mxEvent.consume(Ja)});Ca.appendChild(Fa)}else{var la=document.createElement("input");la.setAttribute("type","checkbox");la.style.margin="0px";la.defaultChecked=null!=ka&&0<=mxUtils.indexOf(ka,ha);la.checked=la.defaultChecked;
la.style.background="transparent";la.setAttribute("title",mxResources.get(la.defaultChecked?"removeIt":"add",[ha]));mxEvent.addListener(la,"change",function(Ja){la.checked?R.addTagsForCells(R.getSelectionCells(),[ha]):R.removeTagsForCells(R.getSelectionCells(),[ha]);mxEvent.consume(Ja)});Ca.appendChild(la)}Ia.appendChild(Ca)}xa.appendChild(Ia)})(ea[ta]);sa.appendChild(xa);ba.appendChild(sa)}}var R=this,X=R.hiddenTags.slice(),Z=document.createElement("div");Z.style.userSelect="none";Z.style.overflow=
"hidden";Z.style.padding="10px";Z.style.height="100%";var ba=document.createElement("div");ba.style.boxSizing="border-box";ba.style.borderRadius="4px";ba.style.userSelect="none";ba.style.overflow="auto";ba.style.position="absolute";ba.style.left="10px";ba.style.right="10px";ba.style.top="10px";ba.style.border=R.isEnabled()?"1px solid #808080":"none";ba.style.bottom=R.isEnabled()?"48px":"10px";Z.appendChild(ba);var aa=mxUtils.button(mxResources.get("reset"),function(ea){R.setHiddenTags([]);mxEvent.isShiftDown(ea)||
(X=R.hiddenTags.slice());U();R.refresh()});aa.setAttribute("title",mxResources.get("reset"));aa.className="geBtn";aa.style.margin="0 4px 0 0";var ca=mxUtils.button(mxResources.get("add"),function(){null!=L&&L(X,function(ea){X=ea;Y()})});ca.setAttribute("title",mxResources.get("add"));ca.className="geBtn";ca.style.margin="0";R.addListener(mxEvent.ROOT,function(){X=R.hiddenTags.slice()});var Y=mxUtils.bind(this,function(ea,ka){if(q()){ea=R.getAllTags();for(ka=0;ka<ea.length;ka++)0>mxUtils.indexOf(X,
ea[ka])&&X.push(ea[ka]);X.sort();R.isSelectionEmpty()?S(X):S(X,R.getCommonTagsForCells(R.getSelectionCells()))}});R.selectionModel.addListener(mxEvent.CHANGE,Y);R.model.addListener(mxEvent.CHANGE,Y);R.addListener(mxEvent.REFRESH,Y);var da=document.createElement("div");da.style.boxSizing="border-box";da.style.whiteSpace="nowrap";da.style.position="absolute";da.style.overflow="hidden";da.style.bottom="0px";da.style.height="42px";da.style.right="10px";da.style.left="10px";R.isEnabled()&&(da.appendChild(aa),
da.appendChild(ca),Z.appendChild(da));return{div:Z,refresh:Y}};Graph.prototype.getCustomFonts=function(){var q=this.extFonts;q=null!=q?q.slice():[];for(var D in Graph.customFontElements){var L=Graph.customFontElements[D];q.push({name:L.name,url:L.url})}return q};Graph.prototype.setFont=function(q,D){Graph.addFont(q,D);document.execCommand("fontname",!1,q);if(null!=D){var L=this.cellEditor.textarea.getElementsByTagName("font");D=Graph.getFontUrl(q,D);for(var U=0;U<L.length;U++)L[U].getAttribute("face")==