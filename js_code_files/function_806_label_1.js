Xa=mxRectangle.fromRectangle(Xa);Xa.width=Math.ceil(Xa.width*ua);Xa.height=Math.ceil(Xa.height*ua);ab*=ua;!Za&&Ga.pageVisible?(Sa=Ga.getPageLayout(),Wa-=Sa.x*Xa.width,$a-=Sa.y*Xa.height):Za=!0;if(null==Ka){Ka=PrintDialog.createPrintPreview(Ga,ab,Xa,0,Wa,$a,Za);Ka.pageSelector=!1;Ka.mathEnabled=!1;da.checked&&(Ka.isCellVisible=function(Ya){return Ga.isCellSelected(Ya)});Wa=q.getCurrentFile();null!=Wa&&(Ka.title=Wa.getTitle());var hb=Ka.writeHead;Ka.writeHead=function(Ya){hb.apply(this,arguments);mxClient.IS_GC&&