[M],"{1} ago"));K.setAttribute("title",E.toLocaleDateString()+" "+E.toLocaleTimeString())}function z(E){var K=document.createElement("img");K.className="geCommentBusyImg";K.src=IMAGE_PATH+"/spin.gif";E.appendChild(K);E.busyImg=K}function A(E){E.style.border="1px solid red";E.removeChild(E.busyImg)}function J(E){E.style.border="";E.removeChild(E.busyImg)}function d(E,K,M,H,N){function P(R,T,W){var X=document.createElement("li");X.className="geCommentAction";var Y=document.createElement("a");Y.className=
"geCommentActionLnk";mxUtils.write(Y,R);X.appendChild(Y);mxEvent.addListener(Y,"click",function(Z){T(Z,E);Z.preventDefault();mxEvent.consume(Z)});S.appendChild(X);W&&(X.style.display="none")}function O(){function R(X){T.push(W);if(null!=X.replies)for(var Y=0;Y<X.replies.length;Y++)W=W.nextSibling,R(X.replies[Y])}var T=[],W=p;R(E);return{pdiv:W,replies:T}}function V(R,T,W,X,Y){function Z(){z(ba);E.addReply(aa,function(fa){aa.id=fa;E.replies.push(aa);J(ba);W&&W()},function(fa){ea();A(ba);b.handleError(fa,
null,null,null,mxUtils.htmlEntities(mxResources.get("objectNotFound")))},X,Y)}function ea(){y(aa,ba,function(fa){Z()},!0)}var ca=O().pdiv,aa=b.newComment(R,b.getCurrentUser());aa.pCommentId=E.id;null==E.replies&&(E.replies=[]);var ba=d(aa,E.replies,ca,H+1);T?ea():Z()}if(N||!E.isResolved){F.style.display="none";var p=document.createElement("div");p.className="geCommentContainer";p.setAttribute("data-commentId",E.id);p.style.marginLeft=20*H+5+"px";E.isResolved&&!Editor.isDarkMode()&&(p.style.backgroundColor=
"ghostWhite");var B=document.createElement("div");B.className="geCommentHeader";var L=document.createElement("img");L.className="geCommentUserImg";L.src=E.user.pictureUrl||Editor.userImage;B.appendChild(L);L=document.createElement("div");L.className="geCommentHeaderTxt";B.appendChild(L);var Q=document.createElement("div");Q.className="geCommentUsername";mxUtils.write(Q,E.user.displayName||"");L.appendChild(Q);Q=document.createElement("div");Q.className="geCommentDate";Q.setAttribute("data-commentId",
E.id);C(E,Q);L.appendChild(Q);p.appendChild(B);B=document.createElement("div");B.className="geCommentTxt";mxUtils.write(B,E.content||"");p.appendChild(B);E.isLocked&&(p.style.opacity="0.5");B=document.createElement("div");B.className="geCommentActions";var S=document.createElement("ul");S.className="geCommentActionsList";B.appendChild(S);g||E.isLocked||0!=H&&!k||P(mxResources.get("reply"),function(){V("",!0)},E.isResolved);L=b.getCurrentUser();null==L||L.id!=E.user.id||g||E.isLocked||(P(mxResources.get("edit"),
function(){function R(){y(E,p,function(){z(p);E.editComment(E.content,function(){J(p)},function(T){A(p);R();b.handleError(T,null,null,null,mxUtils.htmlEntities(mxResources.get("objectNotFound")))})})}R()},E.isResolved),P(mxResources.get("delete"),function(){b.confirm(mxResources.get("areYouSure"),function(){z(p);E.deleteComment(function(R){if(!0===R){R=p.querySelector(".geCommentTxt");R.innerText="";mxUtils.write(R,mxResources.get("msgDeleted"));var T=p.querySelectorAll(".geCommentAction");for(R=
0;R<T.length;R++)T[R].parentNode.removeChild(T[R]);J(p);p.style.opacity="0.5"}else{T=O(E).replies;for(R=0;R<T.length;R++)D.removeChild(T[R]);for(R=0;R<K.length;R++)if(K[R]==E){K.splice(R,1);break}F.style.display=0==D.getElementsByTagName("div").length?"block":"none"}},function(R){A(p);b.handleError(R,null,null,null,mxUtils.htmlEntities(mxResources.get("objectNotFound")))})})},E.isResolved));g||E.isLocked||0!=H||P(E.isResolved?mxResources.get("reopen"):mxResources.get("resolve"),function(R){function T(){var W=
R.target;W.innerText="";E.isResolved=!E.isResolved;mxUtils.write(W,E.isResolved?mxResources.get("reopen"):mxResources.get("resolve"));for(var X=E.isResolved?"none":"",Y=O(E).replies,Z=Editor.isDarkMode()?"transparent":E.isResolved?"ghostWhite":"white",ea=0;ea<Y.length;ea++){Y[ea].style.backgroundColor=Z;for(var ca=Y[ea].querySelectorAll(".geCommentAction"),aa=0;aa<ca.length;aa++)ca[aa]!=W.parentNode&&(ca[aa].style.display=X);U||(Y[ea].style.display="none")}t()}E.isResolved?V(mxResources.get("reOpened")+
": ",!0,T,!1,!0):V(mxResources.get("markedAsResolved"),!1,T,!0)});p.appendChild(B);null!=M?D.insertBefore(p,M.nextSibling):D.appendChild(p);for(M=0;null!=E.replies&&M<E.replies.length;M++)B=E.replies[M],B.isResolved=E.isResolved,d(B,E.replies,null,H+1,N);null!=n&&(n.comment.id==E.id?(N=E.content,E.content=n.comment.content,y(E,p,n.saveCallback,n.deleteOnCancel),E.content=N):null==n.comment.id&&n.comment.pCommentId==E.id&&(D.appendChild(n.div),y(n.comment,n.div,n.saveCallback,n.deleteOnCancel)));return p}}