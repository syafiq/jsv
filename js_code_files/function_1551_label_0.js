[L],"{1} ago"));H.setAttribute("title",z.toLocaleDateString()+" "+z.toLocaleTimeString())}function J(z){var H=document.createElement("img");H.className="geCommentBusyImg";H.src=IMAGE_PATH+"/spin.gif";z.appendChild(H);z.busyImg=H}function D(z){z.style.border="1px solid red";z.removeChild(z.busyImg)}function N(z){z.style.border="";z.removeChild(z.busyImg)}function c(z,H,L,E,M){function P(Q,S,W){var X=document.createElement("li");X.className="geCommentAction";var Y=document.createElement("a");Y.className=
"geCommentActionLnk";mxUtils.write(Y,Q);X.appendChild(Y);mxEvent.addListener(Y,"click",function(Z){S(Z,z);Z.preventDefault();mxEvent.consume(Z)});R.appendChild(X);W&&(X.style.display="none")}function T(){function Q(X){S.push(W);if(null!=X.replies)for(var Y=0;Y<X.replies.length;Y++)W=W.nextSibling,Q(X.replies[Y])}var S=[],W=l;Q(z);return{pdiv:W,replies:S}}function V(Q,S,W,X,Y){function Z(){J(ba);z.addReply(aa,function(ea){aa.id=ea;z.replies.push(aa);N(ba);W&&W()},function(ea){fa();D(ba);b.handleError(ea,
null,null,null,mxUtils.htmlEntities(mxResources.get("objectNotFound")))},X,Y)}function fa(){F(aa,ba,function(ea){Z()},!0)}var ca=T().pdiv,aa=b.newComment(Q,b.getCurrentUser());aa.pCommentId=z.id;null==z.replies&&(z.replies=[]);var ba=c(aa,z.replies,ca,E+1);S?fa():Z()}if(M||!z.isResolved){B.style.display="none";var l=document.createElement("div");l.className="geCommentContainer";l.setAttribute("data-commentId",z.id);l.style.marginLeft=20*E+5+"px";z.isResolved&&!Editor.isDarkMode()&&(l.style.backgroundColor=
"ghostWhite");var x=document.createElement("div");x.className="geCommentHeader";var K=document.createElement("img");K.className="geCommentUserImg";K.src=z.user.pictureUrl||Editor.userImage;x.appendChild(K);K=document.createElement("div");K.className="geCommentHeaderTxt";x.appendChild(K);var O=document.createElement("div");O.className="geCommentUsername";mxUtils.write(O,z.user.displayName||"");K.appendChild(O);O=document.createElement("div");O.className="geCommentDate";O.setAttribute("data-commentId",
z.id);I(z,O);K.appendChild(O);l.appendChild(x);x=document.createElement("div");x.className="geCommentTxt";mxUtils.write(x,z.content||"");l.appendChild(x);z.isLocked&&(l.style.opacity="0.5");x=document.createElement("div");x.className="geCommentActions";var R=document.createElement("ul");R.className="geCommentActionsList";x.appendChild(R);e||z.isLocked||0!=E&&!g||P(mxResources.get("reply"),function(){V("",!0)},z.isResolved);K=b.getCurrentUser();null==K||K.id!=z.user.id||e||z.isLocked||(P(mxResources.get("edit"),
function(){function Q(){F(z,l,function(){J(l);z.editComment(z.content,function(){N(l)},function(S){D(l);Q();b.handleError(S,null,null,null,mxUtils.htmlEntities(mxResources.get("objectNotFound")))})})}Q()},z.isResolved),P(mxResources.get("delete"),function(){b.confirm(mxResources.get("areYouSure"),function(){J(l);z.deleteComment(function(Q){if(!0===Q){Q=l.querySelector(".geCommentTxt");Q.innerText="";mxUtils.write(Q,mxResources.get("msgDeleted"));var S=l.querySelectorAll(".geCommentAction");for(Q=
0;Q<S.length;Q++)S[Q].parentNode.removeChild(S[Q]);N(l);l.style.opacity="0.5"}else{S=T(z).replies;for(Q=0;Q<S.length;Q++)y.removeChild(S[Q]);for(Q=0;Q<H.length;Q++)if(H[Q]==z){H.splice(Q,1);break}B.style.display=0==y.getElementsByTagName("div").length?"block":"none"}},function(Q){D(l);b.handleError(Q,null,null,null,mxUtils.htmlEntities(mxResources.get("objectNotFound")))})})},z.isResolved));e||z.isLocked||0!=E||P(z.isResolved?mxResources.get("reopen"):mxResources.get("resolve"),function(Q){function S(){var W=
Q.target;W.innerText="";z.isResolved=!z.isResolved;mxUtils.write(W,z.isResolved?mxResources.get("reopen"):mxResources.get("resolve"));for(var X=z.isResolved?"none":"",Y=T(z).replies,Z=Editor.isDarkMode()?"transparent":z.isResolved?"ghostWhite":"white",fa=0;fa<Y.length;fa++){Y[fa].style.backgroundColor=Z;for(var ca=Y[fa].querySelectorAll(".geCommentAction"),aa=0;aa<ca.length;aa++)ca[aa]!=W.parentNode&&(ca[aa].style.display=X);U||(Y[fa].style.display="none")}A()}z.isResolved?V(mxResources.get("reOpened")+
": ",!0,S,!1,!0):V(mxResources.get("markedAsResolved"),!1,S,!0)});l.appendChild(x);null!=L?y.insertBefore(l,L.nextSibling):y.appendChild(l);for(L=0;null!=z.replies&&L<z.replies.length;L++)x=z.replies[L],x.isResolved=z.isResolved,c(x,z.replies,null,E+1,M);null!=n&&(n.comment.id==z.id?(M=z.content,z.content=n.comment.content,F(z,l,n.saveCallback,n.deleteOnCancel),z.content=M):null==n.comment.id&&n.comment.pCommentId==z.id&&(y.appendChild(n.div),F(n.comment,n.div,n.saveCallback,n.deleteOnCancel)));return l}}