xa),ta,this);this.fireEvent(new mxEventObject(mxEvent.CELLS_ADDED,"cells",ta))}finally{W.endUpdate()}return ha};Graph.prototype.insertImage=function(y,N,P){if(null!=y&&null!=this.cellEditor.textarea){for(var W=this.cellEditor.textarea.getElementsByTagName("img"),Y=[],ha=0;ha<W.length;ha++)Y.push(W[ha]);document.execCommand("insertimage",!1,y);y=this.cellEditor.textarea.getElementsByTagName("img");if(y.length==Y.length+1)for(ha=y.length-1;0<=ha;ha--)if(0==ha||y[ha]!=Y[ha-1]){y[ha].setAttribute("width",
N);y[ha].setAttribute("height",P);break}}};Graph.prototype.insertLink=function(y){if(null!=this.cellEditor.textarea)if(0==y.length)document.execCommand("unlink",!1);else if(mxClient.IS_FF){for(var N=this.cellEditor.textarea.getElementsByTagName("a"),P=[],W=0;W<N.length;W++)P.push(N[W]);document.execCommand("createlink",!1,mxUtils.trim(y));N=this.cellEditor.textarea.getElementsByTagName("a");if(N.length==P.length+1)for(W=N.length-1;0<=W;W--)if(N[W]!=P[W-1]){for(N=N[W].getElementsByTagName("a");0<N.length;){for(P=