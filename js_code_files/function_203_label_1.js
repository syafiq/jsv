this.user&&this.updateUser(this.emptyFn,this.emptyFn,!0),f(B)):m||401!==B.getStatus()&&400!==B.getStatus()?c(this.parseRequestText(B)):this.authenticate(function(){l(!0)},c,m))}),mxUtils.bind(this,function(B){window.clearTimeout(y);t&&c(B)}))});null==b||6E4>this.tokenExpiresOn-Date.now()?this.authenticate(function(){l(!0)},c):l(!1)};OneDriveClient.prototype.checkToken=function(d,f){null==b||null==this.tokenRefreshThread||6E4>this.tokenExpiresOn-Date.now()?this.authenticate(d,null!=f?f:this.emptyFn):
d()};OneDriveClient.prototype.getItemRef=function(d){var f=d.split("/");return 1<f.length?{driveId:f[0],id:f[1]}:{id:d}};OneDriveClient.prototype.getItemURL=function(d,f){var c=d.split("/");return 1<c.length?(d=c[1],(f?"":this.baseUrl)+"/drives/"+c[0]+("root"==d?"/root":"/items/"+d)):(f?"":this.baseUrl)+"/me/drive/items/"+d};OneDriveClient.prototype.getLibrary=function(d,f,c){this.getFile(d,f,c,!1,!0)};OneDriveClient.prototype.removeExtraHtmlContent=function(d){var f=d.lastIndexOf('<html><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8"><meta name="Robots" ');