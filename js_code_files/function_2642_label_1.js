mxEvent.consume(v)}));d.appendChild(f);return d}return null};EditorUi.prototype.handleError=function(d,f,g,v,x,A,J){var H=null!=this.spinner&&null!=this.spinner.pause?this.spinner.pause():function(){},O=null!=d&&null!=d.error?d.error:d;if(null!=d&&("1"==urlParams.test||null!=d.stack)&&null!=d.message)try{J?null!=window.console&&console.error("EditorUi.handleError:",d):EditorUi.logError("Caught: "+(""==d.message&&null!=d.name)?d.name:d.message,d.filename,d.lineNumber,d.columnNumber,d,"INFO")}catch(aa){}if(null!=
O||null!=f){J=mxUtils.htmlEntities(mxResources.get("unknownError"));var F=mxResources.get("ok"),ea=null;f=null!=f?f:mxResources.get("error");if(null!=O){null!=O.retry&&(F=mxResources.get("cancel"),ea=function(){H();O.retry()});if(404==O.code||404==O.status||403==O.code){J=403==O.code?null!=O.message?mxUtils.htmlEntities(O.message):mxUtils.htmlEntities(mxResources.get("accessDenied")):null!=x?x:mxUtils.htmlEntities(mxResources.get("fileNotFoundOrDenied")+(null!=this.drive&&null!=this.drive.user?" ("+
this.drive.user.displayName+", "+this.drive.user.email+")":""));var ja=null!=x?null:null!=A?A:window.location.hash;if(null!=ja&&("#G"==ja.substring(0,2)||"#Uhttps%3A%2F%2Fdrive.google.com%2Fuc%3Fid%3D"==ja.substring(0,45))&&(null!=d&&null!=d.error&&(null!=d.error.errors&&0<d.error.errors.length&&"fileAccess"==d.error.errors[0].reason||null!=d.error.data&&0<d.error.data.length&&"fileAccess"==d.error.data[0].reason)||404==O.code||404==O.status)){ja="#U"==ja.substring(0,2)?ja.substring(45,ja.lastIndexOf("%26ex")):
ja.substring(2);this.showError(f,J,mxResources.get("openInNewWindow"),mxUtils.bind(this,function(){this.editor.graph.openLink("https://drive.google.com/open?id="+ja);this.handleError(d,f,g,v,x)}),ea,mxResources.get("changeUser"),mxUtils.bind(this,function(){function aa(){V.innerText="";for(var T=0;T<qa.length;T++){var Z=document.createElement("option");mxUtils.write(Z,qa[T].displayName);Z.value=T;V.appendChild(Z);Z=document.createElement("option");Z.innerHTML="&nbsp;&nbsp;&nbsp;";mxUtils.write(Z,
"<"+qa[T].email+">");Z.setAttribute("disabled","disabled");V.appendChild(Z)}Z=document.createElement("option");mxUtils.write(Z,mxResources.get("addAccount"));Z.value=qa.length;V.appendChild(Z)}var qa=this.drive.getUsersList(),sa=document.createElement("div"),K=document.createElement("span");K.style.marginTop="6px";mxUtils.write(K,mxResources.get("changeUser")+": ");sa.appendChild(K);var V=document.createElement("select");V.style.width="200px";aa();mxEvent.addListener(V,"change",mxUtils.bind(this,
function(){var T=V.value,Z=qa.length!=T;Z&&this.drive.setUser(qa[T]);this.drive.authorize(Z,mxUtils.bind(this,function(){Z||(qa=this.drive.getUsersList(),aa())}),mxUtils.bind(this,function(X){this.handleError(X)}),!0)}));sa.appendChild(V);sa=new CustomDialog(this,sa,mxUtils.bind(this,function(){this.loadFile(window.location.hash.substr(1),!0)}));this.showDialog(sa.container,300,100,!0,!0)}),mxResources.get("cancel"),mxUtils.bind(this,function(){this.hideDialog();null!=g&&g()}),480,150);return}}null!=
O.message?J=""==O.message&&null!=O.name?mxUtils.htmlEntities(O.name):mxUtils.htmlEntities(O.message):null!=O.response&&null!=O.response.error?J=mxUtils.htmlEntities(O.response.error):"undefined"!==typeof window.App&&(O.code==App.ERROR_TIMEOUT?J=mxUtils.htmlEntities(mxResources.get("timeout")):O.code==App.ERROR_BUSY?J=mxUtils.htmlEntities(mxResources.get("busy")):"string"===typeof O&&0<O.length&&(J=mxUtils.htmlEntities(O)))}var ia=A=null;null!=O&&null!=O.helpLink?(A=mxResources.get("help"),ia=mxUtils.bind(this,
function(){return this.editor.graph.openLink(O.helpLink)})):null!=O&&null!=O.ownerEmail&&(A=mxResources.get("contactOwner"),J+=mxUtils.htmlEntities(" ("+A+": "+O.ownerEmail+")"),ia=mxUtils.bind(this,function(){return this.openLink("mailto:"+mxUtils.htmlEntities(O.ownerEmail))}));this.showError(f,J,F,g,ea,null,null,A,ia,null,null,null,v?g:null)}else null!=g&&g()};EditorUi.prototype.alert=function(d,f,g){d=new ErrorDialog(this,null,d,mxResources.get("ok"),f);this.showDialog(d.container,g||340,100,!0,