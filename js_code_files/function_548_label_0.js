c(new OneDriveLibrary(this.ui,f,z)):c(new OneDriveFile(this.ui,f,z))});y=this.baseUrl+y+"/children/"+encodeURIComponent(e)+"/content";4E6<=f.length?this.writeFile(y,"","PUT",null,mxUtils.bind(this,function(z){this.writeLargeFile(this.getItemURL(z.id),f,C,l)}),l):this.writeFile(y,f,"PUT",null,C,l)}else l()}))):l({message:this.invalidFilenameRegExs[0].test(e)?mxResources.get("oneDriveCharsNotAllowed"):mxResources.get("oneDriveInvalidDeviceName")})};OneDriveClient.prototype.checkExists=function(e,f,
c,l){var m="/me/drive/root";null!=e&&(m=this.getItemURL(e,!0));this.executeRequest(this.baseUrl+m+"/children/"+encodeURIComponent(f),mxUtils.bind(this,function(t){404==t.getStatus()?l(!0):c?(this.ui.spinner.stop(),this.ui.confirm(mxResources.get("replaceIt",[f]),function(){l(!0)},function(){l(!1)})):(this.ui.spinner.stop(),this.ui.showError(mxResources.get("error"),mxResources.get("fileExists"),mxResources.get("ok"),function(){l(!1)}))}),function(t){l(!1)},!0)};OneDriveClient.prototype.saveFile=function(e,