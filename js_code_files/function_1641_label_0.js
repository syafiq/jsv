u&&null!=u.parentNode&&0<g.length&&(u.parentNode.removeChild(u),u=null)});null!=T&&null!=S&&(/(\.v(dx|sdx?))($|\?)/i.test(S)||/(\.vs(x|sx?))($|\?)/i.test(S))?this.importVisio(T,function(Y){X(Y,"text/xml")},null,S):(new XMLHttpRequest).upload&&this.isRemoteFileFormat(O,S)&&null!=T?this.isExternalDataComms()?this.parseFile(T,mxUtils.bind(this,function(Y){4==Y.readyState&&(this.spinner.stop(),200<=Y.status&&299>=Y.status?X(Y.responseText,"text/xml"):this.handleError({message:mxResources.get(413==Y.status?
"drawingTooLarge":"invalidOrMissingFile")},mxResources.get("errorLoadingFile")))})):(this.spinner.stop(),this.showError(mxResources.get("error"),mxResources.get("notInOffline"))):X(O,V)}}));P.stopPropagation();P.preventDefault()})),mxEvent.addListener(F,"dragleave",function(P){F.style.cursor="";F.style.backgroundColor="";P.stopPropagation();P.preventDefault()}));U=U.cloneNode(!1);U.setAttribute("src",Editor.editImage);U.setAttribute("title",mxResources.get("edit"));G.insertBefore(U,G.firstChild);