f?"&mime="+f:"")+(null!=p?"&format="+p:"")+(null!=q?"&base64="+q:"")+(null!=e?"&filename="+encodeURIComponent(e):"")+(n?"&binary=1":""))};EditorUi.prototype.base64ToBlob=function(c,e){e=e||"";c=atob(c);for(var f=c.length,n=Math.ceil(f/1024),p=Array(n),q=0;q<n;++q){for(var y=1024*q,x=Math.min(y+1024,f),E=Array(x-y),A=0;y<x;++A,++y)E[A]=c[y].charCodeAt(0);p[q]=new Uint8Array(E)}return new Blob(p,{type:e})};EditorUi.prototype.saveLocalFile=function(c,e,f,n,p,q,y,x){q=null!=q?q:!1;y=null!=y?y:"vsdx"!=
p&&(!mxClient.IS_IOS||!navigator.standalone);p=this.getServiceCount(q);isLocalStorage&&p++;var E=4>=p?2:6<p?4:3;e=new CreateDialog(this,e,mxUtils.bind(this,function(A,S){try{if("_blank"==S)if(null!=f&&"image/"==f.substring(0,6))this.openInNewWindow(c,f,n);else if(null!=f&&"text/html"==f.substring(0,9)){var l=new EmbedDialog(this,c);this.showDialog(l.container,450,240,!0,!0);l.init()}else{var u=window.open("about:blank");null==u?mxUtils.popup(c,!0):(u.document.write("<pre>"+mxUtils.htmlEntities(c,
!1)+"</pre>"),u.document.close())}else S==App.MODE_DEVICE||"download"==S?this.doSaveLocalFile(c,A,f,n,null,x):null!=A&&0<A.length&&this.pickFolder(S,mxUtils.bind(this,function(C){try{this.exportFile(c,A,f,n,S,C)}catch(J){this.handleError(J)}}))}catch(C){this.handleError(C)}}),mxUtils.bind(this,function(){this.hideDialog()}),mxResources.get("saveAs"),mxResources.get("download"),!1,q,y,null,1<p,E,c,f,n);q=this.isServices(p)?p>E?390:280:160;this.showDialog(e.container,420,q,!0,!0);e.init()};EditorUi.prototype.openInNewWindow=