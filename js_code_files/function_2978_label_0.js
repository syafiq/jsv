!0),p),B=g;else if(y||null!=this.pages&&this.currentPage!=this.pages[0]){p=this.createTemporaryGraph(y?p.getDefaultStylesheet():p.getStylesheet());var G=p.getGlobalVariable;p.setBackgroundImage=this.editor.graph.setBackgroundImage;var C=this.pages[0];this.currentPage==C?p.setBackgroundImage(this.editor.graph.backgroundImage):null!=C.viewState&&null!=C.viewState&&p.setBackgroundImage(C.viewState.backgroundImage);p.getGlobalVariable=function(U){return"page"==U?C.getName():"pagenumber"==U?1:G.apply(this,
arguments)};document.body.appendChild(p.container);p.model.setRoot(C.root)}this.editor.exportToCanvas(mxUtils.bind(this,function(U){try{null==B&&(B=this.getFileData(!0,null,null,null,null,null,null,null,null,!1));var m=U.toDataURL("image/png");m=Editor.writeGraphModelToPng(m,"tEXt","mxfile",encodeURIComponent(B));c(m.substring(m.lastIndexOf(",")+1));p!=this.editor.graph&&p.container.parentNode.removeChild(p.container)}catch(t){null!=e&&e(t)}}),null,null,null,mxUtils.bind(this,function(U){null!=e&&