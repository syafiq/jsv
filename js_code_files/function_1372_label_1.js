Graph=function(b,e,k,l,C,p){mxGraph.call(this,b,e,k,l);this.themes=C||this.defaultThemes;this.currentEdgeStyle=mxUtils.clone(this.defaultEdgeStyle);this.currentVertexStyle=mxUtils.clone(this.defaultVertexStyle);this.standalone=null!=p?p:!1;b=this.baseUrl;e=b.indexOf("//");this.domainPathUrl=this.domainUrl="";0<e&&(e=b.indexOf("/",e+2),0<e&&(this.domainUrl=b.substring(0,e)),e=b.lastIndexOf("/"),0<e&&(this.domainPathUrl=b.substring(0,e+1)));this.isHtmlLabel=function(K){K=this.getCurrentCellStyle(K);
return null!=K?"1"==K.html||"wrap"==K[mxConstants.STYLE_WHITE_SPACE]:!1};if(this.edgeMode){var D=null,M=null,R=null,G=null,L=!1;this.addListener(mxEvent.FIRE_MOUSE_EVENT,mxUtils.bind(this,function(K,V){if("mouseDown"==V.getProperty("eventName")&&this.isEnabled()){K=V.getProperty("event");var T=K.getState();V=this.view.scale;if(!mxEvent.isAltDown(K.getEvent())&&null!=T)if(this.model.isEdge(T.cell))if(D=new mxPoint(K.getGraphX(),K.getGraphY()),L=this.isCellSelected(T.cell),R=T,M=K,null!=T.text&&null!=
T.text.boundingBox&&mxUtils.contains(T.text.boundingBox,K.getGraphX(),K.getGraphY()))G=mxEvent.LABEL_HANDLE;else{var Z=this.selectionCellsHandler.getHandler(T.cell);null!=Z&&null!=Z.bends&&0<Z.bends.length&&(G=Z.getHandleForEvent(K))}else if(!this.panningHandler.isActive()&&!mxEvent.isControlDown(K.getEvent())&&(Z=this.selectionCellsHandler.getHandler(T.cell),null==Z||null==Z.getHandleForEvent(K))){var X=new mxRectangle(K.getGraphX()-1,K.getGraphY()-1),ka=mxEvent.isTouchEvent(K.getEvent())?mxShape.prototype.svgStrokeTolerance-
1:(mxShape.prototype.svgStrokeTolerance+2)/2;Z=ka+2;X.grow(ka);if(this.isTableCell(T.cell)&&!this.isCellSelected(T.cell)&&!(mxUtils.contains(T,K.getGraphX()-Z,K.getGraphY()-Z)&&mxUtils.contains(T,K.getGraphX()-Z,K.getGraphY()+Z)&&mxUtils.contains(T,K.getGraphX()+Z,K.getGraphY()+Z)&&mxUtils.contains(T,K.getGraphX()+Z,K.getGraphY()-Z))){var q=this.model.getParent(T.cell);Z=this.model.getParent(q);if(!this.isCellSelected(Z)){ka*=V;var E=2*ka;if(this.model.getChildAt(Z,0)!=q&&mxUtils.intersects(X,new mxRectangle(T.x,
T.y-ka,T.width,E))||this.model.getChildAt(q,0)!=T.cell&&mxUtils.intersects(X,new mxRectangle(T.x-ka,T.y,E,T.height))||mxUtils.intersects(X,new mxRectangle(T.x,T.y+T.height-ka,T.width,E))||mxUtils.intersects(X,new mxRectangle(T.x+T.width-ka,T.y,E,T.height)))q=this.selectionCellsHandler.isHandled(Z),this.selectCellForEvent(Z,K.getEvent()),Z=this.selectionCellsHandler.getHandler(Z),null!=Z&&(ka=Z.getHandleForEvent(K),null!=ka&&(Z.start(K.getGraphX(),K.getGraphY(),ka),Z.blockDelayedSelection=!q,K.consume()))}}for(;!K.isConsumed()&&
null!=T&&(this.isTableCell(T.cell)||this.isTableRow(T.cell)||this.isTable(T.cell));)this.isSwimlane(T.cell)&&(Z=this.getActualStartSize(T.cell),(0<Z.x||0<Z.width)&&mxUtils.intersects(X,new mxRectangle(T.x+(Z.x-Z.width-1)*V+(0==Z.x?T.width:0),T.y,1,T.height))||(0<Z.y||0<Z.height)&&mxUtils.intersects(X,new mxRectangle(T.x,T.y+(Z.y-Z.height-1)*V+(0==Z.y?T.height:0),T.width,1)))&&(this.selectCellForEvent(T.cell,K.getEvent()),Z=this.selectionCellsHandler.getHandler(T.cell),null!=Z&&(ka=mxEvent.CUSTOM_HANDLE-
Z.customHandles.length+1,Z.start(K.getGraphX(),K.getGraphY(),ka),K.consume())),T=this.view.getState(this.model.getParent(T.cell))}}}));this.addMouseListener({mouseDown:function(K,V){},mouseMove:mxUtils.bind(this,function(K,V){K=this.selectionCellsHandler.handlers.map;for(var T in K)if(null!=K[T].index)return;if(this.isEnabled()&&!this.panningHandler.isActive()&&!mxEvent.isAltDown(V.getEvent())){var Z=this.tolerance;if(null!=D&&null!=R&&null!=M){if(T=R,Math.abs(D.x-V.getGraphX())>Z||Math.abs(D.y-V.getGraphY())>
Z){var X=this.selectionCellsHandler.getHandler(T.cell);null==X&&this.model.isEdge(T.cell)&&(X=this.createHandler(T));if(null!=X&&null!=X.bends&&0<X.bends.length){K=X.getHandleForEvent(M);var ka=this.view.getEdgeStyle(T);Z=ka==mxEdgeStyle.EntityRelation;L||G!=mxEvent.LABEL_HANDLE||(K=G);if(Z&&0!=K&&K!=X.bends.length-1&&K!=mxEvent.LABEL_HANDLE)!Z||null==T.visibleSourceState&&null==T.visibleTargetState||(this.graphHandler.reset(),V.consume());else if(K==mxEvent.LABEL_HANDLE||0==K||null!=T.visibleSourceState||
K==X.bends.length-1||null!=T.visibleTargetState)Z||K==mxEvent.LABEL_HANDLE||(Z=T.absolutePoints,null!=Z&&(null==ka&&null==K||ka==mxEdgeStyle.OrthConnector)&&(K=G,null==K&&(K=new mxRectangle(D.x,D.y),K.grow(mxEdgeHandler.prototype.handleImage.width/2),mxUtils.contains(K,Z[0].x,Z[0].y)?K=0:mxUtils.contains(K,Z[Z.length-1].x,Z[Z.length-1].y)?K=X.bends.length-1:null!=ka&&(2==Z.length||3==Z.length&&(0==Math.round(Z[0].x-Z[1].x)&&0==Math.round(Z[1].x-Z[2].x)||0==Math.round(Z[0].y-Z[1].y)&&0==Math.round(Z[1].y-
Z[2].y)))?K=2:(K=mxUtils.findNearestSegment(T,D.x,D.y),K=null==ka?mxEvent.VIRTUAL_HANDLE-K:K+1))),null==K&&(K=mxEvent.VIRTUAL_HANDLE)),X.start(V.getGraphX(),V.getGraphX(),K),V.consume(),this.graphHandler.reset()}null!=X&&(this.selectionCellsHandler.isHandlerActive(X)?this.isCellSelected(T.cell)||(this.selectionCellsHandler.handlers.put(T.cell,X),this.selectCellForEvent(T.cell,V.getEvent())):this.isCellSelected(T.cell)||X.destroy());L=!1;D=M=R=G=null}}else if(T=V.getState(),null!=T&&this.isCellEditable(T.cell)){X=
null;if(this.model.isEdge(T.cell)){if(K=new mxRectangle(V.getGraphX(),V.getGraphY()),K.grow(mxEdgeHandler.prototype.handleImage.width/2),Z=T.absolutePoints,null!=Z)if(null!=T.text&&null!=T.text.boundingBox&&mxUtils.contains(T.text.boundingBox,V.getGraphX(),V.getGraphY()))X="move";else if(mxUtils.contains(K,Z[0].x,Z[0].y)||mxUtils.contains(K,Z[Z.length-1].x,Z[Z.length-1].y))X="pointer";else if(null!=T.visibleSourceState||null!=T.visibleTargetState)K=this.view.getEdgeStyle(T),X="crosshair",K!=mxEdgeStyle.EntityRelation&&
this.isOrthogonal(T)&&(V=mxUtils.findNearestSegment(T,V.getGraphX(),V.getGraphY()),V<Z.length-1&&0<=V&&(X=0==Math.round(Z[V].x-Z[V+1].x)?"col-resize":"row-resize"))}else if(!mxEvent.isControlDown(V.getEvent())){Z=mxShape.prototype.svgStrokeTolerance/2;K=new mxRectangle(V.getGraphX(),V.getGraphY());K.grow(Z);if(this.isTableCell(T.cell)&&(V=this.model.getParent(T.cell),Z=this.model.getParent(V),!this.isCellSelected(Z)))if(mxUtils.intersects(K,new mxRectangle(T.x,T.y-2,T.width,4))&&this.model.getChildAt(Z,
0)!=V||mxUtils.intersects(K,new mxRectangle(T.x,T.y+T.height-2,T.width,4)))X="row-resize";else if(mxUtils.intersects(K,new mxRectangle(T.x-2,T.y,4,T.height))&&this.model.getChildAt(V,0)!=T.cell||mxUtils.intersects(K,new mxRectangle(T.x+T.width-2,T.y,4,T.height)))X="col-resize";for(V=T;null==X&&null!=V&&(this.isTableCell(V.cell)||this.isTableRow(V.cell)||this.isTable(V.cell));)this.isSwimlane(V.cell)&&(Z=this.getActualStartSize(V.cell),ka=this.view.scale,(0<Z.x||0<Z.width)&&mxUtils.intersects(K,new mxRectangle(V.x+
(Z.x-Z.width-1)*ka+(0==Z.x?V.width*ka:0),V.y,1,V.height))?X="col-resize":(0<Z.y||0<Z.height)&&mxUtils.intersects(K,new mxRectangle(V.x,V.y+(Z.y-Z.height-1)*ka+(0==Z.y?V.height:0),V.width,1))&&(X="row-resize")),V=this.view.getState(this.model.getParent(V.cell))}null!=X&&T.setCursor(X)}}}),mouseUp:mxUtils.bind(this,function(K,V){G=D=M=R=null})})}this.cellRenderer.minSvgStrokeWidth=.1;this.cellRenderer.getLabelValue=function(K){var V=mxCellRenderer.prototype.getLabelValue.apply(this,arguments);K.view.graph.isHtmlLabel(K.cell)&&