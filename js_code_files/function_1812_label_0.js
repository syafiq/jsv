7!=document.documentMode||this.isOfflineApp()||mxClient.IS_IOS};EditorUi.prototype.showTextDialog=function(d,g){d=new TextareaDialog(this,d,g,null,null,mxResources.get("close"));this.showDialog(d.container,620,460,!0,!0,null,null,null,null,!0);d.init();document.execCommand("selectall",!1,null)};EditorUi.prototype.doSaveLocalFile=function(d,g,k,n,x,u){"text/xml"!=k||/(\.drawio)$/i.test(g)||/(\.xml)$/i.test(g)||/(\.svg)$/i.test(g)||/(\.html)$/i.test(g)||(g=g+"."+(null!=u?u:"drawio"));if(window.Blob&&
navigator.msSaveOrOpenBlob)d=n?this.base64ToBlob(d,k):new Blob([d],{type:k}),navigator.msSaveOrOpenBlob(d,g);else if(mxClient.IS_IE)k=window.open("about:blank","_blank"),null==k?mxUtils.popup(d,!0):(k.document.write(d),k.document.close(),k.document.execCommand("SaveAs",!0,g),k.close());else if(mxClient.IS_IOS&&this.isOffline())navigator.standalone||null==k||"image/"!=k.substring(0,6)?this.showTextDialog(g+":",d):this.openInNewWindow(d,k,n);else{var D=document.createElement("a");u=(null==navigator.userAgent||
0>navigator.userAgent.indexOf("PaleMoon/"))&&"undefined"!==typeof D.download;if(mxClient.IS_GC&&null!=navigator.userAgent){var F=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);u=65==(F?parseInt(F[2],10):!1)?!1:u}if(u||this.isOffline()){D.href=URL.createObjectURL(n?this.base64ToBlob(d,k):new Blob([d],{type:k}));u?D.download=g:D.setAttribute("target","_blank");document.body.appendChild(D);try{window.setTimeout(function(){URL.revokeObjectURL(D.href)},2E4),D.click(),D.parentNode.removeChild(D)}catch(I){}}else this.createEchoRequest(d,
g,k,n,x).simulate(document,"_blank")}};EditorUi.prototype.createEchoRequest=function(d,g,k,n,x,u){d="xml="+encodeURIComponent(d);return new mxXmlRequest(SAVE_URL,d+(null!=k?"&mime="+k:"")+(null!=x?"&format="+x:"")+(null!=u?"&base64="+u:"")+(null!=g?"&filename="+encodeURIComponent(g):"")+(n?"&binary=1":""))};EditorUi.prototype.base64ToBlob=function(d,g){g=g||"";d=atob(d);for(var k=d.length,n=Math.ceil(k/1024),x=Array(n),u=0;u<n;++u){for(var D=1024*u,F=Math.min(D+1024,k),I=Array(F-D),G=0;D<F;++G,++D)I[G]=