!P)if("sharepoint"==N)I("site",null,H.id,H.displayName);else if("site"==N)I("subsite",null,H.id,H.name);else{var T=H.folder;H=H.remoteItem?H.remoteItem:H;var W=(H.parentReference?H.parentReference.driveId:null)||N,X=H.id;T?I(W,X,null,H.name):x()}}function I(T,W,X,Y,Z){function ea(ya){E.stop();var Ea=document.createElement("table");Ea.className="odFileListGrid";for(var Fa=null,qa=0,ta=0;null!=ya&&ta<ya.length;ta++){var la=ya[ta];if(1!=ba||!la.webUrl||0<la.webUrl.indexOf("sharepoint.com/sites/")||0>
la.webUrl.indexOf("sharepoint.com/")){var ua=la.displayName||la.name,Ma=mxUtils.htmlEntities(la.description||ua);ba&&(la.folder=2==ba?{isRoot:!0}:!0);var Ia=null!=la.folder;if(!C||Ia){var ia=document.createElement("tr");ia.className=qa++%2?"odOddRow":"odEvenRow";var va=document.createElement("td");va.style.width="36px";var sa=document.createElement("img");sa.src="/images/"+(Ia?"folder.png":"file.png");sa.className="odFileImg";va.appendChild(sa);ia.appendChild(va);va=document.createElement("td");Ia=
document.createElement("div");Ia.className="odFileTitle";Ia.innerHTML=mxUtils.htmlEntities(ua);Ia.setAttribute("title",Ma);va.appendChild(Ia);ia.appendChild(va);Ea.appendChild(ia);null==Fa&&(Fa=ia,Fa.className+=" odRowSelected",H=la,N=T,g||e(H));(function(na,oa){ia.addEventListener("dblclick",F);ia.addEventListener("click",function(){Fa!=oa&&(Fa.className=Fa.className.replace("odRowSelected",""),Fa=oa,Fa.className+=" odRowSelected",H=na,N=T,g||e(H))})})(la,ia)}}}0==qa?(ya=document.createElement("div"),
ya.className="odEmptyFolder",ya.innerHTML=mxUtils.htmlEntities(mxResources.get("folderEmpty",null,"Folder is empty!")),za.appendChild(ya)):za.appendChild(Ea);D();P=!1}function ca(ya){f(ya?ya:ha,function(Ea){if(aa){var Fa=Ea.value||[];if(g||ba)Array.prototype.push.apply(Pa,Fa);else for(var qa=0;qa<Fa.length;qa++){var ta=Fa[qa],la=ta.file?ta.file.mimeType:null;(ta.folder||"text/html"==la||"text/xml"==la||"application/xml"==la||"image/png"==la||/\.svg$/.test(ta.name)||/\.html$/.test(ta.name)||/\.xml$/.test(ta.name)||