function(m){try{this.ui.spinner.stop(),f(m.getHash().substring(1),m)}catch(t){c(t)}}),c,!0)}),c)}),mxUtils.bind(this,function(){this.ui.spinner.stop()}))};DropboxClient.prototype.pickFile=function(e,f){null!=Dropbox.choose?(e=null!=e?e:mxUtils.bind(this,function(c,l){this.ui.loadFile(null!=c?"D"+encodeURIComponent(c):l.getHash(),null,l)}),Dropbox.choose({linkType:"direct",cancel:mxUtils.bind(this,function(){}),success:mxUtils.bind(this,function(c){if(this.ui.spinner.spin(document.body,mxResources.get("loading")))if(f)this.ui.spinner.stop(),
e(c[0].link);else{var l=mxUtils.bind(this,function(z){this.ui.spinner.stop();this.ui.handleError(z)}),m=mxUtils.bind(this,function(z,A){this.ui.spinner.stop();e(z,A)}),t=/\.png$/i.test(c[0].name);if(/\.vsdx$/i.test(c[0].name)||/\.gliffy$/i.test(c[0].name)||!this.ui.useCanvasForExport&&t)m(c[0].link);else{var y=c[0].link.indexOf(this.appPath);if(0<y){var C=decodeURIComponent(c[0].link.substring(y+this.appPath.length-1));this.readFile({path:C},mxUtils.bind(this,function(z,A){if(null!=A&&A.id==c[0].id){var J=
t?z.lastIndexOf(","):-1;this.ui.spinner.stop();var d=null;0<J&&(J=this.ui.extractGraphModelFromPng(z),null!=J&&0<J.length?z=J:d=new LocalFile(this,z,C,!0));e(C.substring(1),null!=d?d:new DropboxFile(this.ui,z,A))}else this.createFile(c[0],m,l)}),l,t)}else this.createFile(c[0],m,l)}}})})):this.ui.handleError({message:mxResources.get("serviceUnavailableOrBlocked")})};DropboxClient.prototype.createFile=function(e,f,c){var l=/(\.png)$/i.test(e.name);this.ui.editor.loadUrl(e.link,mxUtils.bind(this,function(m){null!=