d[D].charCodeAt(0);x[u]=new Uint8Array(I)}return new Blob(x,{type:g})};EditorUi.prototype.saveLocalFile=function(d,g,k,n,x,u,D,F){u=null!=u?u:!1;D=null!=D?D:"vsdx"!=x&&(!mxClient.IS_IOS||!navigator.standalone);x=this.getServiceCount(u);isLocalStorage&&x++;var I=4>=x?2:6<x?4:3;g=new CreateDialog(this,g,mxUtils.bind(this,function(G,U){try{if("_blank"==U)if(null!=k&&"image/"==k.substring(0,6))this.openInNewWindow(d,k,n);else if(null!=k&&"text/html"==k.substring(0,9)){var q=new EmbedDialog(this,d);this.showDialog(q.container,
450,240,!0,!0);q.init()}else{var v=window.open("about:blank");null==v?mxUtils.popup(d,!0):(v.document.write("<pre>"+mxUtils.htmlEntities(d,!1)+"</pre>"),v.document.close())}else U==App.MODE_DEVICE||"download"==U?this.doSaveLocalFile(d,G,k,n,null,F):null!=G&&0<G.length&&this.pickFolder(U,mxUtils.bind(this,function(E){try{this.exportFile(d,G,k,n,U,E)}catch(K){this.handleError(K)}}))}catch(E){this.handleError(E)}}),mxUtils.bind(this,function(){this.hideDialog()}),mxResources.get("saveAs"),mxResources.get("download"),
!1,u,D,null,1<x,I,d,k,n);u=this.isServices(x)?x>I?390:280:160;this.showDialog(g.container,420,u,!0,!0);g.init()};EditorUi.prototype.openInNewWindow=function(d,g,k){var n=window.open("about:blank");null==n||null==n.document?mxUtils.popup(d,!0):("image/svg+xml"!=g||mxClient.IS_SVG?"image/svg+xml"!=g||k?(d=k?d:btoa(unescape(encodeURIComponent(d))),n.document.write('<html><img style="max-width:100%;" src="data:'+g+";base64,"+d+'"/></html>')):n.document.write("<html>"+d+"</html>"):n.document.write("<html><pre>"+