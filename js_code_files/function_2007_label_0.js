p.baseUrl||Q.crossOriginImages&&Q.isCorsEnabledForUrl(Z)?"chrome-extension://"==Z.substring(0,19)||mxClient.IS_CHROMEAPP||(Z=E.apply(this,arguments)):Z=PROXY_URL+"?url="+encodeURIComponent(Z)}return Z};return p};Editor.createSvgDataUri=function(p){return"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(p)))};Editor.prototype.convertImageToDataUri=function(p,E){try{var Q=!0,Z=window.setTimeout(mxUtils.bind(this,function(){Q=!1;E(Editor.svgBrokenImage.src)}),this.timeout);if(/(\.svg)$/i.test(p))mxUtils.get(p,
mxUtils.bind(this,function(X){window.clearTimeout(Z);Q&&E(Editor.createSvgDataUri(X.getText()))}),function(){window.clearTimeout(Z);Q&&E(Editor.svgBrokenImage.src)});else{var W=new Image;this.crossOriginImages&&(W.crossOrigin="anonymous");W.onload=function(){window.clearTimeout(Z);if(Q)try{var X=document.createElement("canvas"),da=X.getContext("2d");X.height=W.height;X.width=W.width;da.drawImage(W,0,0);E(X.toDataURL())}catch(la){E(Editor.svgBrokenImage.src)}};W.onerror=function(){window.clearTimeout(Z);
Q&&E(Editor.svgBrokenImage.src)};W.src=p}}catch(X){E(Editor.svgBrokenImage.src)}};Editor.prototype.convertImages=function(p,E,Q,Z){null==Z&&(Z=this.createImageUrlConverter());var W=0,X=Q||{};Q=mxUtils.bind(this,function(da,la){da=p.getElementsByTagName(da);for(var pa=0;pa<da.length;pa++)mxUtils.bind(this,function(ma){try{if(null!=ma){var qa=Z.convert(ma.getAttribute(la));if(null!=qa&&"data:"!=qa.substring(0,5)){var za=X[qa];null==za?(W++,this.convertImageToDataUri(qa,function(ya){null!=ya&&(X[qa]=