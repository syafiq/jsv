c.style.textAlign="right";var e=mxUtils.button(mxResources.get("help"),function(){b.openLink("https://www.diagrams.net/doc/faq/plugins")});e.className="geBtn";b.isOffline()&&!mxClient.IS_CHROMEAPP&&(e.style.display="none");c.appendChild(e);b.editor.cancelFirst?(d||c.appendChild(D),c.appendChild(J),c.appendChild(N)):(c.appendChild(J),c.appendChild(N),d||c.appendChild(D));v.appendChild(c);this.container=v},CropImageDialog=function(b,f,k,d){function u(){var U=q.checked,m=p.checked,t=e.geometry,z=I.width,
H=I.height,L=(300-z)/2,E=(300-H)/2;t.x<L?(t.width-=L-t.x,t.x=L):t.x+t.width>L+z&&(t.width=L+z-t.x,t.x=Math.min(t.x,L+z));t.y<E?(t.height-=E-t.y,t.y=E):t.y+t.height>E+H&&(t.height=E+H-t.y,t.y=Math.min(t.y,E+H));var M=(t.x-L)/z*100;z=100-(t.x+t.width-L)/z*100;L=(t.y-E)/H*100;t=100-(t.y+t.height-E)/H*100;return"inset("+mxUtils.format(L)+"% "+mxUtils.format(z)+"% "+mxUtils.format(t)+"% "+mxUtils.format(M)+"%"+(U?" round "+c+"%":m?" round 50%":"")+")"}function v(U){null!=D&&(!0!==U&&(D.model.setGeometry(e,
N.clone()),c=5,B.value=c),D.model.setStyle(e,g+u()),D.selectAll(),y.style.visibility=q.checked?"visible":"hidden")}var A=document.createElement("div"),F=document.createElement("div");F.style.height="300px";F.style.width="300px";F.style.display="inline-flex";F.style.justifyContent="center";F.style.alignItems="center";F.style.position="absolute";var I=document.createElement("img");I.onload=function(){function U(){D.model.setStyle(e,g+u())}D=new Graph(J);D.autoExtend=!1;D.autoScroll=!1;D.setGridEnabled(!1);
D.setEnabled(!0);D.setPanning(!1);D.setConnectable(!1);D.getRubberband().setEnabled(!1);D.graphHandler.allowLivePreview=!1;var m=D.createVertexHandler;D.createVertexHandler=function(){var R=m.apply(this,arguments);R.livePreview=!1;return R};if(null!=k)try{if("inset"==k.substring(0,5)){var t=e.geometry,z=I.width,H=I.height,L=(300-z)/2,E=(300-H)/2,M=k.match(/\(([^)]+)\)/)[1].split(/[ ,]+/),P=parseFloat(M[0]),T=parseFloat(M[1]),V=parseFloat(M[2]),l=parseFloat(M[3]);isFinite(P)&&isFinite(T)&&isFinite(V)&&
isFinite(l)?(t.x=l/100*z+L,t.y=P/100*H+E,t.width=(100-T)/100*z+L-t.x,t.height=(100-V)/100*H+E-t.y,"round"==M[4]?"50%"==M[5]?p.setAttribute("checked","checked"):(c=parseInt(M[5]),B.value=c,q.setAttribute("checked","checked"),y.style.visibility="visible"):n.setAttribute("checked","checked")):k=null}else k=null}catch(R){}e.style=g+(k?k:u());e.vertex=!0;D.addCell(e,null,null,null,null);D.selectAll();D.addListener(mxEvent.CELLS_MOVED,U);D.addListener(mxEvent.CELLS_RESIZED,U);var x=D.graphHandler.mouseUp,
K=D.graphHandler.mouseDown;D.graphHandler.mouseUp=function(){x.apply(this,arguments);J.style.backgroundColor="#fff9"};D.graphHandler.mouseDown=function(){K.apply(this,arguments);J.style.backgroundColor=""};D.dblClick=function(){};var O=D.getSelectionModel().changeSelection;D.getSelectionModel().changeSelection=function(){O.call(this,[e],[e])}};I.onerror=function(){I.onload=null;I.src=Editor.errorImage};I.setAttribute("src",f);I.style.maxWidth="300px";I.style.maxHeight="300px";F.appendChild(I);A.appendChild(F);
var J=document.createElement("div");J.style.width="300px";J.style.height="300px";J.style.overflow="hidden";J.style.backgroundColor="#fff9";A.appendChild(J);var D=null,N=new mxGeometry(100,100,100,100),c=5,e=new mxCell("",N.clone(),""),g="shape=image;fillColor=none;rotatable=0;cloneable=0;deletable=0;image="+f.replace(";base64","")+";clipPath=",n=document.createElement("input");n.setAttribute("type","radio");n.setAttribute("id","croppingRect");n.setAttribute("name","croppingShape");n.setAttribute("checked",
"checked");n.style.margin="5px";A.appendChild(n);f=document.createElement("label");f.setAttribute("for","croppingRect");mxUtils.write(f,mxResources.get("rectangle"));A.appendChild(f);var q=document.createElement("input");q.setAttribute("type","radio");q.setAttribute("id","croppingRounded");q.setAttribute("name","croppingShape");q.style.margin="5px";A.appendChild(q);f=document.createElement("label");f.setAttribute("for","croppingRounded");mxUtils.write(f,mxResources.get("rounded"));A.appendChild(f);
var p=document.createElement("input");p.setAttribute("type","radio");p.setAttribute("id","croppingEllipse");p.setAttribute("name","croppingShape");p.style.margin="5px";A.appendChild(p);f=document.createElement("label");f.setAttribute("for","croppingEllipse");mxUtils.write(f,mxResources.get("ellipse"));A.appendChild(f);mxEvent.addListener(n,"change",v);mxEvent.addListener(q,"change",v);mxEvent.addListener(p,"change",v);var y=document.createElement("div");y.style.textAlign="center";y.style.visibility=
"hidden";var B=document.createElement("input");B.setAttribute("type","range");B.setAttribute("min","1");B.setAttribute("max","49");B.setAttribute("value",c);B.setAttribute("title",mxResources.get("arcSize"));y.appendChild(B);A.appendChild(y);mxEvent.addListener(B,"change",function(){c=this.value;v(!0)});f=mxUtils.button(mxResources.get("cancel"),function(){b.hideDialog()});f.className="geBtn";F=mxUtils.button(mxResources.get("apply"),function(){d(u(),e.geometry.width,e.geometry.height);b.hideDialog()});
F.className="geBtn gePrimaryBtn";var G=mxUtils.button(mxResources.get("reset"),function(){d(null,I.width,I.height);b.hideDialog()});G.className="geBtn";var C=document.createElement("div");C.style.marginTop="10px";C.style.textAlign="right";b.editor.cancelFirst?(C.appendChild(f),C.appendChild(G),C.appendChild(F)):(C.appendChild(G),C.appendChild(F),C.appendChild(f));A.appendChild(C);this.container=A},EditGeometryDialog=function(b,f){var k=b.editor.graph,d=1==f.length?k.getCellGeometry(f[0]):null,u=document.createElement("div"),