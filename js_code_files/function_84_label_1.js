DriveClient.prototype.authorize=function(f,c,l,m,t){this.isExtAuth&&!f?window.parent.driveAuth(mxUtils.bind(this,function(y){this.updateAuthInfo(y,!0,!0,c,l)}),l):(new mxXmlRequest(this.redirectUri+"?getState=1",null,"GET")).send(mxUtils.bind(this,function(y){200<=y.getStatus()&&299>=y.getStatus()?this.authorizeStep2(y.getText(),f,c,l,m,t):null!=l&&l(y)}),l)};DriveClient.prototype.updateAuthInfo=function(f,c,l,m,t){b=f.access_token;delete f.access_token;f.expires=Date.now()+1E3*parseInt(f.expires_in);
f.remember=c;this.resetTokenRefresh(f);this.authCalled=!0;if(l||null==this.user){var y=JSON.stringify(f);this.updateUser(mxUtils.bind(this,function(){var B=JSON.parse(y);this.setPersistentToken(B,!c);null!=m&&m()}),t)}else null!=m&&(this.setPersistentToken(f,!c),m())};DriveClient.prototype.authorizeStep2=function(f,c,l,m,t,y){try{null!=this.ui.stateArg&&null!=this.ui.stateArg.userId&&(this.userId=this.ui.stateArg.userId,null!=this.user&&this.user.id!=this.userId&&(this.user=null));if(null==this.userId){var B=