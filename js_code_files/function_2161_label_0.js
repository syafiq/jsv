d){if(d.hasAttribute("scale")){var n=parseFloat(d.getAttribute("scale"));!isNaN(n)&&0<n&&(g=n)}d.hasAttribute("border")&&(n=parseInt(d.getAttribute("border")),!isNaN(n)&&0<n&&(k=n))}return{scale:g,border:k}};EditorUi.prototype.getEmbeddedPng=function(d,g,k,n,x){try{var u=this.editor.graph,D=null!=u.themes&&"darkTheme"==u.defaultThemeName,F=null;if(null!=k&&0<k.length)u=this.createTemporaryGraph(D?u.getDefaultStylesheet():u.getStylesheet()),document.body.appendChild(u.container),this.decodeNodeIntoGraph(this.editor.extractGraphModel(mxUtils.parseXml(k).documentElement,
!0),u),F=k;else if(D||null!=this.pages&&this.currentPage!=this.pages[0]){u=this.createTemporaryGraph(D?u.getDefaultStylesheet():u.getStylesheet());var I=u.getGlobalVariable;u.setBackgroundImage=this.editor.graph.setBackgroundImage;var G=this.pages[0];this.currentPage==G?u.setBackgroundImage(this.editor.graph.backgroundImage):null!=G.viewState&&null!=G.viewState&&u.setBackgroundImage(G.viewState.backgroundImage);u.getGlobalVariable=function(U){return"page"==U?G.getName():"pagenumber"==U?1:I.apply(this,
arguments)};document.body.appendChild(u.container);u.model.setRoot(G.root)}this.editor.exportToCanvas(mxUtils.bind(this,function(U){try{null==F&&(F=this.getFileData(!0,null,null,null,null,null,null,null,null,!1));var q=U.toDataURL("image/png");q=Editor.writeGraphModelToPng(q,"tEXt","mxfile",encodeURIComponent(F));d(q.substring(q.lastIndexOf(",")+1));u!=this.editor.graph&&u.container.parentNode.removeChild(u.container)}catch(v){null!=g&&g(v)}}),null,null,null,mxUtils.bind(this,function(U){null!=g&&
g(U)}),null,null,n,null,u.shadowVisible,null,u,x,null,null,null,"diagram",null)}catch(U){null!=g&&g(U)}};EditorUi.prototype.getEmbeddedSvg=function(d,g,k,n,x,u,D,F,I,G,U,q,v){F=null!=F?F:!0;U=null!=U?U:0;D=null!=I?I:g.background;D==mxConstants.NONE&&(D=null);u=g.getSvg(D,G,U,null,null,u,null,null,null,g.shadowVisible||q,null,v,"diagram");(g.shadowVisible||q)&&g.addSvgShadow(u,null,null,0==U);null!=d&&u.setAttribute("content",d);null!=k&&u.setAttribute("resource",k);var E=mxUtils.bind(this,function(K){K=